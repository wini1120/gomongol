# 여행후기 MVP 실제 운영 검토

## 1. 현재 구현 상태 요약

| 구분 | 구현 여부 | 비고 |
|------|-----------|------|
| DB (travel_review, review_photo) | ✅ | RLS SELECT/INSERT/UPDATE, Storage 정책 |
| 목록·카드·모달 | ✅ | 카드 클릭 → 모달, 사진 슬라이드, 기간/인원/여행지 고정 |
| 후기 작성 | ✅ | 여행사 선택(ACTIVE/DONE), 사진 최대 5장, 지역 복수 선택 |
| 여행사 상세·후기 모달 | ✅ | 소개글, 후기 목록, 동일 모달 UX |
| 메인 연결 | ✅ | 여행후기 등록 버튼, 인증 여행사 카드 → 상세 페이지 |

---

## 2. 실제 운영 시 유의할 점

### 2.1 보안·권한

- **익명 작성**: RLS가 `anon`에 INSERT/UPDATE를 전부 허용하고 있어, 누구나 후기를 등록·수정할 수 있음.
  - **권장**: MVP에서는 괜찮을 수 있으나, 악성/스팸 글이 늘어나면 **작성자 식별(이메일, 전화번호, 간단 가입)** 또는 **관리자만 수정/삭제**로 단계적 강화 검토.
- **Storage**: `review-photos` 버킷에 anon INSERT 허용 → 업로드 용량·파일 수 제한이 없으면 비용·악용 가능성 있음.
  - **권장**: Supabase Dashboard에서 버킷 **파일 크기/개수 제한** 설정, 필요 시 업로드 전 프론트에서 이미지 리사이즈·용량 제한.

### 2.2 데이터·운영

- **수정/삭제 없음**: 작성 후 수정·삭제 기능이 없음.
  - MVP: 관리자가 DB에서 직접 수정/삭제(`is_delete` 플래그 등) 가능하다고 가정하면 운영 가능.
  - 이후: “내가 쓴 후기” 식별 후 수정/삭제 UI 추가 검토.
- **작성자 정보 없음**: `travel_review`에 작성자(닉네임, 연락처 등) 컬럼이 없음.
  - 현재는 “어느 여행사 후기인지”만 보임. MVP로는 가능, 이후 신뢰도·문의용으로 작성자 정보 추가 검토.

### 2.3 UX·안정성

- **에러 처리**: 업로드/저장 실패 시 `setError(err?.message)`로 메시지만 표시. 네트워크 끊김·Storage 오류 등은 사용자에게 “잠시 후 다시 시도해 주세요” 등 안내가 있으면 좋음.
- **대용량 이미지**: 리사이즈 없이 원본 업로드 → 용량·비용 증가. MVP 후 **클라이언트 리사이즈** 또는 Supabase Image Transformation 도입 권장.
- **빈 목록**: 인증 여행사(ACTIVE/DONE)가 없으면 작성 페이지에서 “인증된 여행사가 없습니다”만 표시. 메인/보드에서 “후기 작성은 여행사 입점 후 가능” 등 한 줄 안내 있으면 좋음.

### 2.4 인프라·설정

- **Storage 버킷**: `review-photos` 버킷을 Public으로 생성하고, SQL에 있는 Storage RLS 정책을 반드시 실행해야 함. 미실행 시 업로드/노출 오류 발생.
- **agency_user.company_intro**: 여행사 소개 페이지용. 기존 테이블에 `ALTER TABLE`로 추가하는 SQL이 있으므로, 이미 운영 중인 DB면 한 번만 실행 필요.

---

## 3. MVP로 실제 운영해 보기 판단

- **바로 운영 가능한 부분**
  - 후기 **열람**(목록·카드·모달, 여행사별 후기)
  - 후기 **작성**(여행사 선택, 사진 5장, 기간/인원/지역)
  - 여행사 소개 + 후기 목록 + 동일 모달
  - 메인에서 여행후기·인증 여행사 진입

- **운영 전 확인할 것**
  1. Supabase에 `supabase_travel_review.sql` 전체 실행 여부(테이블·RLS·Storage 정책).
  2. Storage에 `review-photos` 버킷 생성 및 Public 설정.
  3. (선택) Storage 버킷 파일 크기/개수 제한 설정.

- **운영하면서 보완하면 좋은 것**
  - 잘못된/스팸 후기 대응: DB에서 `is_delete` 수동 처리 또는 관리자 도구.
  - 이미지 용량·비용: 업로드 전 리사이즈 또는 서버/이미지 변환 도입.
  - 작성자 식별·수정/삭제: 트래픽·신뢰도 보고 단계적 도입.

---

## 4. 결론

- **MVP로 실제 운영해 보기에 무리 없는 수준**이다.  
  읽기·쓰기·여행사 연결·모달 UX까지 한 사이클이 갖춰져 있고, DB·Storage·화면 흐름이 맞물려 동작한다.
- **실서비스 전**에는 Supabase(테이블·RLS·버킷·Storage 정책) 설정이 모두 적용됐는지, 그리고 “익명 작성 + 수정/삭제 없음” 정책을 잠깐이라도 수용할지만 결정하면 된다.
- 위 “운영하면서 보완” 항목은 트래픽과 피드백을 본 뒤 순서를 정해 단계적으로 반영하는 것을 권장한다.
