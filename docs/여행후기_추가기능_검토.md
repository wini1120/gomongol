# 여행 후기 추가 기능 검토 (구현 전 검토)

> 코드 반영 없이 정책·구조만 검토합니다.

---

## 1. 악의적 후기 / 신고·삭제

### 현재
- 후기는 익명(필명) 작성, “이용 후 작성”은 작성자 체크만 존재.
- DB/앱에 **신고 기능·삭제 권한·운영자 삭제 플로우**는 없음.

### “신고 받아서 삭제하면 되나?”
- **가능은 함.** 운영자가 신고 접수 후 DB에서 해당 후기 `is_delete = 'Y'` 처리하거나 레코드 삭제하면 노출은 막을 수 있음.
- 다만 그렇게만 하면:
  - **근거 부족**: 왜 삭제했는지 기록이 없으면 나중에 분쟁·문의 대응이 어렵다.
  - **반복 방지 부족**: 같은 사람이 다시 가입해 비슷한 후기를 올릴 수 있음 (로그인 없으면 더 쉬움).
  - **법적 리스크**: 허위·비방 성격이면 명예훼손 등에서 “삭제만으로 충분한 대응인지” 이슈가 생길 수 있음.

### 권장 방향
1. **이용약관/후기 정책**  
   - “해당 여행사를 이용한 사실이 없는데 이용 후인 것처럼 작성하면 삭제·제재할 수 있다”는 조항을 두는 것이 좋음.
2. **삭제 시 기록**  
   - “삭제 사유(신고·정책 위반 등), 처리 일시, 처리자(또는 시스템)”를 로그나 별도 테이블에 남기면 나중에 검증·분쟁 대응에 유리함.
3. **신고 버튼(선택)**  
   - 후기 상세/목록에 “신고” 버튼을 두고, 신고 내용을 DB나 운영 채널(이메일/폼)로 받으면, “신고 접수 → 검토 → 삭제/유지” 절차를 갖출 수 있음.
4. **단기**  
   - 당장은 “운영자가 신고 접수 후 수동으로 DB/관리 화면에서 삭제”로 시작하고, 위 정책·기록만 정리해 두는 것도 가능함.

**요약**: “신고 받아서 삭제”만으로도 운영은 가능하지만, 약관·삭제 사유 기록·(선택) 신고 플로우를 두면 안정적이고 나중에 확장하기 좋음.

---

## 2. 후기 작성에 ID/PW 필요 + 동행찾기와 통합

### 의도 정리
- 후기 작성 시 **반드시 로그인(계정)** 하게 하고,
- 계정이 없으면 **여기서 회원가입**,
- 이미 **동행찾기에서 만든 계정**이 있으면 그걸로 로그인해서 후기 작성.

### “동행찾기랑 회원가입 루트가 2개라 ID 하나로 기본키 설정이 애매하다”
- **기본키**: 지금처럼 `travel_user.user_no`(BIGSERIAL)를 PK로 두는 것은 그대로 유지해도 됨.  
  “가입 경로가 2개”여도, **한 번 가입한 사람 = 레코드 1개**이면 PK는 하나면 충분함.
- **애매한 부분**은 “동행찹기에서 가입” vs “후기에서 처음 가입”일 때 **같은 사람이 두 번 가입하지 않게 하는지**일 가능성이 큼.

### ID만 두는 경우
- `user_id`(로그인 ID)를 UNIQUE로 두고,  
  동행찾기·후기 작성 모두 **같은 `travel_user` 테이블**을 쓰면:
  - 동행찾기에서 먼저 가입 → `user_id`로 로그인 → 후기 작성 시 같은 계정 사용.
  - 후기에서 먼저 가입 → 나중에 동행찾기 들어가도 같은 `user_id`로 로그인하면 하나의 계정으로 통합됨.
- 따라서 **가입 진입점이 2개여도, 테이블·PK는 하나**로 두는 것이 자연스럽고, “ID 하나로 기본키”가 애매해질 필요는 없음. (PK는 `user_no`, 로그인/중복 방지는 `user_id` UNIQUE.)

### 전화번호를 후보키로 두는 경우
- **목적**  
  - (1) 같은 사람이 ID만 바꿔서 중복 가입하는 것 방지  
  - (2) 본인 확인·복구·연락용
- **장점**  
  - 전화번호 UNIQUE(또는 후보키)로 하면 “이 번호로 이미 가입된 계정이 있다”고 막거나, 기존 계정과 연결할 수 있음.  
  - 분쟁·신고 시 “연락처 보유” 근거가 하나 생김.
- **단점/고려**  
  - 개인정보 수집·이용·보관 정책 필요 (개인정보처리방침, 동의, 최소 수집).  
  - 인증(SMS 등)을 하지 않으면 “잘못 입력한 번호”“타인 번호”로 인한 문제 가능.  
  - 수집 시 반드시 법적 요구사항(동의, 목적 명시, 보관 기간 등) 정리 필요.

### 권장
- **1단계**  
  - 후기 작성 시 **로그인 필수**로 전환하고,  
  - 동행찾기와 **같은 `travel_user`(ID/PW)** 를 쓰도록 하면,  
  - “동행찹기에서 만든 계정 = 후기에서 쓰는 계정”이 되고, PK/테이블 구조는 지금처럼 유지 가능.
- **2단계(선택)**  
  - “전화번호 후보키”는 **본인 확인·중복 가입 방지**가 정말 필요해질 때 도입하는 것을 권장.  
  - 도입 시: 수집 목적, 동의, 암호화/보안, 보관 기간, 인증 여부(SMS 등)를 정리한 뒤 추가하는 것이 안전함.

**요약**:  
- 가입 경로가 2개여도 **한 테이블·한 PK(user_no)·user_id UNIQUE**로 통합 가능.  
- 전화번호 후보키는 “필수”보다는 “본인 확인/중복 방지가 필요할 때 + 개인정보 처리 정책 정리 후” 도입하는 편이 좋음.

---

## 3. “등록 여행사와 여행 안 해도 후기 쓸 수 있게”

### 현재
- 후기는 “여행사 선택 + 제목/사진/내용” 구조.
- “이용 후 작성” 체크 시 “이용 후 작성” 뱃지만 표시되고, **반드시 그 여행사 이용자만 쓸 수 있는 제한**은 없음.

### 요구
- “해당 여행사와 여행하지 않았어도 후기를 쓸 수 있는 구조”가 필요.

### 해석
- (A) **그 여행사는 이용 안 했지만**, 후기를 남기고 싶은 경우  
  - 예: 다른 경로로 다녀왔는데, 특정 여행사에 대한 견적·문의 경험을 남기고 싶다.  
  - 예: 취소했거나 이용 전인데, 정보성 후기를 남기고 싶다.
- (B) **이용한 여행사가 목록에 없어서** “기타”로라도 쓰고 싶은 경우  
  - 예: 등록되지 않은 여행사로 다녀왔는데, 지역/코스 후기만 남기고 싶다.

### 구조 제안(개념만)
1. **여행사는 선택 유지**  
   - 후기는 “어느 여행사에 대한/어느 여행사와 관련된 후기인지”를 선택하게 두고,  
   - “이용 후 작성”은 **선택(체크)** 으로만 두면 됨.  
   - 이미 “이용 후 작성” 체크를 안 하면 뱃지가 안 붙으므로, **이용 안 한 후기**는 자연스럽게 “이용 후 작성”이 아님으로 구분 가능.
2. **“이용 안 함” 명시(선택)**  
   - UI에서 “이 여행사 이용했나요?” → [예 / 아니오] 또는  
   - “이용 후 작성” 체크를 **해당 시 체크, 미해당 시 비체크**로 두면,  
   - “이용 안 함” 후기는 뱃지 없이 노출되며, 설명 문구로 “해당 여행사 이용 전/기타” 등으로 안내할 수 있음.
3. **등록되지 않은 여행사**  
   - “여행사 선택”에 **“기타(미등록 여행사)”** 옵션을 두고,  
   - 선택 시 여행사명을 텍스트로 받거나, “연결된 여행사 없음”으로 저장하면,  
   - “등록 여행사와 여행 안 한 경우”까지 포함할 수 있음.  
   - 이때 DB에는 `agency_user_id`를 NULL 허용하거나, “기타”용 더미/시스템 계정 하나 두는 방식 등이 필요함.

### 정리
- **이용 여부**  
  - 지금처럼 “이용 후 작성”을 체크 여부로만 두어도, “여행사와 여행 안 했어도 후기 작성 가능”은 충족됨.  
  - 필요하면 “이용 안 함”을 한 번 더 드러내는 문구/라벨만 추가하면 됨.
- **미등록 여행사**  
  - “기타(미등록 여행사)” 선택 + 여행사명 텍스트 저장 등으로, 등록 여행사가 아니어도 후기 작성 경로를 열 수 있음.  
  - 이 부분만 DB/UI에서 “기타” 케이스를 허용하도록 설계하면 됨.

---

## 정리 표

| 항목 | 결론 |
|------|------|
| 1. 악의적 후기·신고·삭제 | 삭제만으로도 운영 가능. 약관·삭제 사유 기록·(선택) 신고 플로우 두면 좋음. |
| 2. 후기 작성 시 ID/PW + 동행 통합 | 동행찾기와 같은 `travel_user`로 로그인 필수화하면 됨. PK/테이블 분리는 불필요. 전화번호 후보키는 개인정보 정책 정리 후 선택 도입. |
| 3. 여행사와 여행 안 해도 후기 | “이용 후 작성” 비체크로 이미 가능. “기타(미등록 여행사)” 옵션 추가하면 미등록 여행사 후기까지 가능. |

원하시면 1·2·3 중 하나만 골라서 “다음 단계: 구체적인 DB 스키마/API/화면 플로우”만 더 쪼개서 정리해 드리겠습니다.
